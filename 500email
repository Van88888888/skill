#!/usr/bin/env python
# -*- coding: utf-8 -*-
from __future__ import unicode_literals, print_function, division, absolute_import
import smtplib
from datetime import datetime, date, timedelta
import pytz
import time
import datetime
from email.mime.text import MIMEText
from email.mime.image import MIMEImage
from email.mime.multipart import MIMEMultipart
from email.header import Header
from email.utils import formataddr
from email.mime.application import MIMEApplication
import xlrd
import emoji

input_dir = '/Users/mawei/Downloads/50-100/'
file_name = 'email.xls'
data = xlrd.open_workbook(input_dir + file_name)
print(data.sheet_names())
table = data.sheet_by_name('Sheet1')
print(table.name, table.nrows, table.ncols)
row_4 = table.row_values(3)
print(row_4)
col_3 = table.col_values(2)
print(col_3, type(col_3), len(col_3))
col_1 = table.col_values(0)
print(col_1, type(col_1), len(col_1))
print(col_1[0:500], type(col_1[0:500]), len(col_1[0:500]))
#time.sleep(1000000)

emoji_blush = emoji.emojize(':blush:', use_aliases=True)
emoji_v = emoji.emojize(':v:', use_aliases=True)
print(emoji.emojize(':blush:', use_aliases=True), type(emoji_blush))  # Python is ğŸ‘
# æœ‰äº›ç‰¹æ®Šçš„è¡¨æƒ…éœ€è¦æŒ‡å®š use_aliases=True å‚æ•°æ‰å¯ä»¥å®ç°
print(emoji.emojize(':v:', use_aliases=True))  # Sleeping is ğŸ’¤

mail_host = "smtp.exmail.qq.com"
mail_user = "mawei@mail.i-i.ai"
mail_pass = "3927040Mavi"

url = "https://ai-indeed.com/"
m = MIMEMultipart()
m['From'] = formataddr(["pupai", mail_user])
#m['To'] = ','.join(to_recv)
#m['Bcc'] = ','.join(bcc_recv)
subject = 'ã€æ±‚èŒã€‘è´µå…¬å¸æ‹›äººå—ï¼Ÿ'
m['Subject'] = Header(subject, 'utf-8')

col_3 = ['mawei@mail.i-i.ai', 'mwsuccess@163.com', '35952686@qq.com', 'sunlinchun@mail.i-i.ai,',
            'sunlinchun@mail.i-i.ai,', 'yuwenwei@mail.i-i.ai', 'zhuweirong@mail.i-i.ai',
'gaoyang@mail.i-i.ai,', 'fangjian@mail.i-i.ai', 'zhangjunjiu@mail.i-i.ai',
'zhangjunyan@mail.i-i.ai,', 'gaochen@mail.i-i.ai', 'xiangxinxin@mail.i-i.ai']
col_1 = ['mawe', 'mmm', 'aaa', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸',
         'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸',
         'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸']


# col_1 = ['å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸', 'å®åœ¨æ™ºèƒ½ç§‘æŠ€æœ‰é™å…¬å¸']
# col_3 = ['mawei@mail.i-i.ai', 'mwsuccess@163.com']

smtpObj = smtplib.SMTP()
smtpObj.connect(mail_host, 25)
smtpObj.login(mail_user, mail_pass)

for i in range(2):  # 500 emails
    company_info = """
        <p>
        <font size="4.5" face="KaiTi">
    {}ï¼Œæ‚¨å¥½ï¼
        </font>
        </p>
    """.format(col_1[i])

    html_info = """
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">
    Helloï¼Œæˆ‘å«ç« å°é±¼ï¼Œæ˜¯æ¥åº”è˜çš„æ–°åŒå­¦ï¼Œå¯¹è´µå…¬å¸å‘å¸ƒçš„å²—ä½å¾ˆæ„Ÿå…´è¶£ï¼Œä¸€å¥è¯æ€»ç»“æœ¬äººèƒ½åŠ›äº®ç‚¹â€”â€”<b>æˆ‘èƒ½7*ï¸24å·¥ä½œå“¦ï¼</b>
        </font>
        </p>    
        
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">
    æ˜¯çš„ï¼Œæ‚¨æ²¡çœ‹é”™ï¼ä¼°è®¡å¯èƒ½æœ‰ç‚¹å„¿ä¸æ˜è§‰å‰å§{} å¦‚æœå†è¡¥å……ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘å¯ä»¥ä¸åƒä¸å–ã€æ— ä¼‘æ— æ­¢ã€ä»¥æ•°åå€æ•ˆç‡ã€é«˜å‡†ç¡®æ€§å®Œæˆå·¥ä½œï¼Œèƒœä»»ç»å¤§å¤šæ•°é€šè¿‡ç”µè„‘å®Œæˆçš„å¸¸è§„åœºæ™¯ç­‰ï¼Œæˆ‘æƒ³æ‚¨æ²¡å‡†ä¼šä¸€æ‹å¤§è…¿ï¼Œçœ¼å‰ä¸€äº®ï¼Œååˆ†æœŸå¾…äº†è§£æˆ‘æ˜¯è°ï¼šï¼‰    
        </font>
        </p>  
            
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">
    å“ˆï¼Œæˆ‘æ˜¯ã€Œå®åœ¨æ™ºèƒ½ã€é€šè¿‡<b>â€œç« é±¼RPAâ€</b>å¼€å‘çš„æ™ºèƒ½è½¯ä»¶æœºå™¨äººï¼Œæ‚¨ä¹Ÿå¯ä»¥å«æˆ‘â€œæ•°å­—å‘˜å·¥â€{}ã€‚ </font>
        </p>    
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">    
    æˆ‘å¯ä»¥è¾…åŠ©æ‚¨å¤„ç†å¤§é‡é‡å¤ã€è§„åˆ™ã€æµç¨‹åŒ–çš„ç”µè„‘ç«¯å·¥ä½œï¼Œèƒ½å¤Ÿè¯†åˆ«å„ç§ç¥¨æ®æ–‡æ¡£å›¾ç‰‡ã€å¯ä»¥é€šè¿‡æ™ºèƒ½äº¤äº’èŠå¤©æ–¹å¼å›ç­”é—®é¢˜ã€ç†è§£è¯‰æ±‚æˆ–è€…è·å–ä¿¡æ¯â€¦â€¦ç”šè‡³åœ¨ä¸€äº›éœ€è¦å‡­ç»éªŒåšå‡ºå†³ç­–åˆ¤æ–­çš„å¤æ‚åœºæ™¯ä¹Ÿæ¸¸åˆƒæœ‰ä½™å“¦{}ã€‚    </font>
        </p>    
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">
    æˆ‘è¿˜å¯ä»¥èº«å…¼å¤šèŒï¼Œ<b>äººåŠ›ã€è´¢åŠ¡ã€é”€å”®ã€è¿ç»´ã€å®¢æœã€è¿è¥ã€è¡Œæ”¿</b>ç»Ÿç»Ÿéƒ½èƒ½æå®šï¼Œè®©æˆ‘è¾…åŠ©æ‚¨åœ¨å·¥ä½œä¸Šå¤§æ”¾å¼‚å½©å§ï¼
        </font>
        </p>
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">    
        æ¬¢è¿è”ç³»æˆ‘çš„å°å§å§ï½
        </font>
        </p>    
        <p style="text-indent:1cm;">
        <font size="4.5" face="KaiTi">    
        æœ±å°ä¸ƒï¼š13575786820
        </font>
        </p>    
    <p style="text-indent:0cm;">
     <img  src= "https://yuyinzhijian.oss-cn-hangzhou.aliyuncs.com/email_pics/%E6%9C%B1%E5%B0%8F%E4%B8%83.jpg" height="185" width="160"> 
       </p>    
    
        <br>
        <br>
        
    <p style="text-indent:8cm;">
     <img  src= "https://yuyinzhijian.oss-cn-hangzhou.aliyuncs.com/email_pics/%E9%82%AE%E4%BB%B6%E9%85%8D%E5%9B%BE-%E9%95%BF%E5%9B%BE.png" > 
       </p>    
        
        
        <p>
        <font size="4.5" face="KaiTi" color="red">  
        <b>ç« é±¼RPAè¯•ç”¨é“¾æ¥ï¼š</b>
        </font>
        </p>
        
        
        <p>
         
        <a href="https://ai-indeed.com/">
        <font size="4.5" face="KaiTi" color="red"> ç‚¹æˆ‘ç‚¹æˆ‘</font></a>
        
        </p>
        """.format(emoji_blush, emoji_v, emoji_v)
    html_sub = MIMEText(company_info + html_info, 'html', 'utf-8')
    # å¦‚æœä¸åŠ ä¸‹è¾¹è¿™è¡Œä»£ç çš„è¯ï¼Œä¸Šè¾¹çš„æ–‡æœ¬æ˜¯ä¸ä¼šæ­£å¸¸æ˜¾ç¤ºçš„ï¼Œä¼šæŠŠè¶…æ–‡æœ¬çš„å†…å®¹å½“åšæ–‡æœ¬æ˜¾ç¤º
    #html_sub["Content-Disposition"] = 'attachment; filename="csdn.html"'
    m.attach(html_sub)
    smtpObj.sendmail('mawei@mail.i-i.ai', col_3[i], m.as_string())




